(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}})();function me(e){return`
  <i class=${e>=1?"'fas  fa-star'":e>=.5?"'fas fa-star-half-alt'":"'far fa-star'"}></i>
  <i class=${e>=2?"'fas fa-star'":e>=1.5?"'fas fa-star-half-alt'":"'far fa-star'"}></i>
  <i class=${e>=3?"'fas fa-star'":e>=2.5?"'fas fa-star-half-alt'":"'far fa-star'"}></i>
  <i class=${e>=4?"'fas fa-star'":e>=3.5?"'fas fa-star-half-alt'":"'far fa-star'"}></i>
  <i class=${e>=5?"'fas fa-star'":e>=4.5?"'fas fa-star-half-alt'":"'far fa-star'"}></i>
  `}const j=[{_id:1,name:"Rascador T-4000",image:["img/products/scraper.jpg","img/products/scraperModal1.jpg","img/products/scraperModal2.jpg","img/products/scraperModal3.jpg"],description:"Los gatos tienen un impulso natural de rascarse: la acci\xF3n les ayuda a eliminar material viejo de sus garras y marcar el territorio con las gl\xE1ndulas olorosas de sus patas.",price:89,rating:4},{_id:2,name:"Headphone Pro",image:["img/products/headphone.jpg","img/products/headphoneModal1.jpg","img/products/headphoneModal2.jpg","img/products/headphoneModal3.jpg"],description:"El Headphone Pro tiene bajos m\xE1s potentes, mejora la experiencia de audio, proporciona una alta calidad de sonido.",price:150,rating:3.5},{_id:3,name:"Mochila Pet 7000",image:["img/products/mochila.jpg","img/products/mochilaModal1.jpg","img/products/mochilaModal2.jpg","img/products/mochilaModal3.jpg"],description:"Ideal para visitas al veterinario, paseos, viajes, o para llevarla donde quieras!, Incluye varios orificios amplios para ventilaci\xF3n, adem\xE1s de contar con un acr\xEDlico que protege a tu mascota.",price:99,rating:4.5}];function N(e,t){localStorage.setItem(e,JSON.stringify(t))}function g(e){return JSON.parse(localStorage.getItem(e))}function X(e,t){sessionStorage.setItem(e,JSON.stringify(t))}function $(e){return JSON.parse(sessionStorage.getItem(e))}function V(e){sessionStorage.removeItem(e)}const w=16,J=w,pe=function(e){return btoa(String.fromCharCode(...new Uint8Array(e)))},fe=function(e){return Uint8Array.from(atob(e),t=>t.charCodeAt(0))},Y=async function(e){const t=new TextEncoder;let a="AES-CBC",o=await window.crypto.subtle.importKey("raw",t.encode(e.password),{name:"PBKDF2"},!1,["deriveKey"]);return await window.crypto.subtle.deriveKey({name:"PBKDF2",salt:t.encode(e.sal.toString()),iterations:e.iterations,hash:e.hash},o,{name:a,length:e.longitude},!1,["encrypt","decrypt"])};async function P(e,t){const a=new TextEncoder,o=window.crypto.getRandomValues(new Uint8Array(16)),n=window.crypto.getRandomValues(new Uint8Array(16)),s=a.encode(t),i=Y({password:e,sal:o,iterations:1e5,longitude:256,hash:"SHA-256"}),d=await window.crypto.subtle.encrypt({name:"AES-CBC",iv:n},await i,s);return pe([...o,...n,...new Uint8Array(d)])}async function ee(e,t){const a=new TextDecoder,o=fe(t),n=o.slice(0,w),s=o.slice(0+w,w+J),i=Y({password:e,sal:n,iterations:1e5,longitude:256,hash:"SHA-256"}),d=await window.crypto.subtle.decrypt({name:"AES-CBC",iv:s},await i,o.slice(w+J));return a.decode(d)}let q;const ye=new Uint8Array(16);function ge(){if(!q&&(q=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!q))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return q(ye)}const u=[];for(let e=0;e<256;++e)u.push((e+256).toString(16).slice(1));function ve(e,t=0){return(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase()}const be=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),K={randomUUID:be};function te(e,t,a){if(K.randomUUID&&!t&&!e)return K.randomUUID();e=e||{};const o=e.random||(e.rng||ge)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t){a=a||0;for(let n=0;n<16;++n)t[a+n]=o[n];return t}return ve(o)}const he=j;function Ee(e){const t=document.querySelector("#divAccordion");e.purchase.reverse().map((a,o)=>{const n=document.createElement("h2");n.className="accordion-header",n.id="accordion"+o;const s=document.createElement("button");s.className="accordion-button",s.type="button",s.setAttribute("data-bs-toggle","collapse"),s.setAttribute("data-bs-target","#colpase"+o),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-controls","colpase"+o);const r=new Date(a.date).toLocaleDateString(void 0,{weekday:"short",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"});s.innerText=r;const i=document.createElement("div");i.id="colpase"+o,i.className="accordion-collapse collapse show",i.setAttribute("aria-labelledby","accordion"+o);const d=document.createElement("div");d.className="accordion-body px-1";const p=document.createElement("span");p.className="fw-600",p.innerText="ID: "+a._id;const c=document.createElement("table");c.className="table table-sm table-bordered mt-2",c.innerHTML+=`
    <thead>
       <tr>        
        <th scope="col">Producto</th>
        <th scope="col">P.U</th>
        <th scope="col">Subtotal</th>        
      </tr>
    </thead>       
    `;let f=0;for(let l=0;l<a.items.length;l++){const y=he.find(v=>v._id===a.items[l]._id);f+=a.items[l].quantity*y.price,c.innerHTML+=`          
        <tbody>
          <tr >            
            <td scope="row">
              <a href="#staticBackdrop${y._id}" data-bs-toggle="modal">
               ${y.name+" - x"+a.items[l].quantity}
              </a>
            </td>
            <td class="text-end">${y.price}</td>
            <td class="text-end">${a.items[l].quantity*y.price}</td>
          </tr>    
        </tbody>`}c.innerHTML+=`
      <tfoot>
        <tr class="text-end"> 
          <td></td>           
          <td class="fw-bolder">Total: </td>
          <td>$ ${f}</td>
        </tr>   
      </tfoot>`,n.append(s),d.append(p,c),i.append(d),t.append(n),t.append(i)})}const G=document.querySelector("#accordionItems"),Se=g("users");function R(e){G.innerHTML="";const t=document.createElement("div");t.id="divAccordion";const a=document.createElement("div");a.className="card mb-2";const o=document.createElement("div");o.className="card-header d-flex flex-row justify-content-between";const n=document.createElement("p");n.innerText="Hola, "+e.username;const s=document.createElement("a");s.href="#",s.innerText="Cerrar sesi\xF3n",s.addEventListener("click",l=>{l.preventDefault(),V("user"),location.reload()});const r=document.createElement("ul");r.className="list-group list-group-flush";const i=document.createElement("li");i.className="list-group-item",i.innerText=e.email;const d=document.createElement("li");d.className="list-group-item d-flex flex-row justify-content-between";const p=document.createElement("p");p.innerText="Compras realizadas: "+e.purchase.length;const c=document.createElement("button");c.type="button",c.className="btn btn-danger icon-cart",c.title="Eliminar cuenta";const f=document.createElement("i");f.className="fas fa-trash-alt",c.append(f),c.addEventListener("click",()=>{if(confirm("\xBFQuieres borrar este perfil y sus datos?")){let l=Se.filter(y=>y.email!==e.email);N("users",l),V("user"),location.reload()}return null}),d.append(p,c),o.append(n,s),a.append(o),a.append(r),r.append(i,d),t.append(a),G.append(t),e.purchase.length>0&&Ee(e)}const xe=document.querySelector("#nav-profile-tab");async function we(){const e=g("carrito"),t=$("user"),a=g("users");t.purchase.push({_id:te(),date:new Date,items:e}),console.log(t.purchase),X("user",t),xe.click();const o=await ee(t.email,t._id),n=await P(o,JSON.stringify({email:t.email,username:t.username,_id:t._id,purchase:t.purchase})),s=a.map(r=>r.email===t.email?{...r,user:n}:r);Le(s),alert("Gracias por su compra "+t.username),R(t)}function Le(e){se(),N("users",e),N("carrito",[]),ae()}const I=document.querySelector("#cartContainer"),Q=document.querySelector("#precioTotal"),L=document.querySelector("#btnPay"),z=document.querySelector("#contadorCarrito"),Ne=document.querySelector("#loginRegisterModal"),Te=j;function qe(e){let t=0,a=0;e.length===0&&(I.innerHTML="",Q.innerText="DSS",L.innerText="M\xE9dios de pago",L.classList.add("disabled"),z.innerText="0"),e.map(o=>{const n=Te.find(ue=>ue._id===o._id);a+=o.quantity,z.innerText=a.toString();const s=document.createElement("div");s.className="d-flex align-items-center gap-2 mb-2";const r=document.createElement("a");r.href="#staticBackdrop"+n._id,r.setAttribute("data-bs-toggle","modal");const i=document.createElement("img");i.src=n.image[0],i.className="img-cart img-thumbnail";const d=document.createElement("div");d.className="d-flex flex-wrap justify-content-between w-100 gap-2 me-auto";const p=document.createElement("div");p.className="me-auto";const c=document.createElement("div");c.innerText=n.name+" ",c.className="justify-content-start ";const f=document.createElement("span");f.className="text-muted quantity-cart",f.innerText="x "+o.quantity.toString();const l=document.createElement("div");l.className="text-muted price-cart",l.innerText="$ "+n.price.toString();const y=document.createElement("div");y.innerText="$ "+(n.price*o.quantity).toString(),t+=n.price*o.quantity;const v=document.createElement("div");v.className="d-flex flex-wrap gap-1 col-12";const h=document.createElement("button");h.type="button",h.className="btn btn-outline-primary icon-cart",h.addEventListener("click",()=>{ke(o._id)});const O=document.createElement("i");O.className="fas fa-minus";const E=document.createElement("button");E.type="button",E.className="btn btn-danger icon-cart",E.addEventListener("click",()=>{confirm("Desea eliminar el producto: "+(n==null?void 0:n.name))&&$e(o._id)});const H=document.createElement("i");H.className="fas fa-trash-alt";const S=document.createElement("button");S.type="button",S.className="btn btn-outline-primary icon-cart",S.addEventListener("click",()=>{ne(o._id)});const F=document.createElement("i");return F.className="fas fa-plus",h.append(O),E.append(H),S.append(F),o.quantity>1&&(c.append(f),v.append(h)),p.append(c),p.append(l),v.append(E),v.append(S),d.append(p),d.append(y),d.append(v),r.append(i),s.append(r),s.append(d),Q.innerText="Total : $ "+t.toString(),L.innerText="Pagar",L.classList.remove("disabled"),I==null?void 0:I.append(s)})}L.addEventListener("click",()=>{$("user")?we():(alert("Registrese o inicie sesi\xF3n para completar la venta"),Ne.click())});let m=[];const Ie=document.querySelector("#cartContainer");function ae(){m=g("carrito"),M(m),m.forEach(e=>{e!=null&&e._id&&A(e._id,!0)})}function ne(e){m.find(t=>t._id===e)==null?m=[...m,{_id:e,quantity:1}]:m.map(t=>t._id===e?(t.quantity+=1,{...t,quantity:t.quantity}):t),M(m),A(e,!0)}function ke(e){var t;((t=m.find(a=>a._id===e))==null?void 0:t.quantity)===1?(m=m.filter(a=>a._id!==e),A(e,!1)):m.map(a=>a._id===e?(a.quantity-=1,{...a,quantity:a.quantity}):a),M(m)}function $e(e){m=m.filter(t=>t._id!==e),M(m),A(e,!1)}function A(e,t){const a=document.querySelector("#icon"+e);t?a.className="fas fa-check-circle ms-1":a.className=" "}function M(e){Ie.innerHTML="",qe(e),N("carrito",e)}function Ce({_id:e,name:t,image:a,description:o}){return document.getElementById("productModal").innerHTML+=`
  <div class="modal fade" id="staticBackdrop${e}" key="${e}" >
    <div class="modal-dialog modal-md ">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title px-0" id="exampleModalLabel">${t}</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="container-fluid">
            <div class="row">
              <div class="col-12">
                <div id="carouselExampleIndicators${e}" class="carousel carousel-dark slide" data-bs-ride="carousel">
                  <div class="carousel-indicators">
                    <button type="button" data-bs-target="#carouselExampleIndicators${e}" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators${e}" data-bs-slide-to="1" aria-label="Slide 2"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators${e}" data-bs-slide-to="2" aria-label="Slide 3"></button>
                  </div>
                  <div class="carousel-inner text-center">
                    ${a.map((n,s)=>s>0&&s<=3?`<div class="carousel-item  ${s===1?"active":""}">
                          <img src="${n}" class="d-block w-100 img-thumbnail" alt="${t}">
                        </div>`:null)}
                  </div>
                  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators${e}" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators${e}" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                  </button>
                </div>
              </div>
              <div class="col-12  text-center pt-2">
                <p>${o}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>`}const k=document.querySelector("#productSection"),oe=j;function se(){k.innerHTML=" ",oe.forEach(e=>{const t=document.createElement("div");t.className="col";const a=document.createElement("div");a.className="card";const o=document.createElement("a");o.href="#staticBackdrop"+e._id,o.setAttribute("data-bs-toggle","modal");const n=document.createElement("img");n.src=e.image[0],n.className="card-img-top",n.setAttribute("alt",e.name);const s=document.createElement("div");s.className="card-body";const r=document.createElement("span");r.textContent=e.name,r.className="card-title d-flex justify-content-between bgn fs-3 mb-2";const i=document.createElement("span");i.innerText="$ "+e.price.toString(),i.className="fs-5";const d=document.createElement("div");d.innerHTML=me(e.rating);const p=document.createElement("div");p.className="d-grid col-6 mx-auto mb-3";const c=document.createElement("button");c.className="btn btn-outline-dark btn-custom text-break",c.innerText="A\xF1adir ";const f=document.createElement("i");f.id="icon"+e._id,c.addEventListener("click",()=>{ne(e._id)});const l=document.createElement("i");l.className="fa-solid fa-shopping-cart",r.append(i),s.append(r),s.append(d),c.append(l),c.append(f),p.append(c),o.append(n),a.append(o),a.append(s),a.append(p),t.append(a),k==null||k.append(t)})}oe.forEach(e=>{Ce(e)});const _=document.querySelector("#registerForm"),re=_.username,ce=document.querySelector("#loginButton"),ie=document.querySelector("#registerButton"),U=document.querySelector("#activeBtnLogin"),B=document.querySelector("#activeBtnRegister"),de=document.querySelector("#modalTitle");function Ae(){U.addEventListener("click",()=>{re.classList.add("visually-hidden"),ie.classList.add("visually-hidden"),U.classList.add("visually-hidden"),ce.classList.remove("visually-hidden"),B.classList.remove("visually-hidden"),de.innerText="Iniciar sesi\xF3n",_.classList.remove("was-validated")})}function Me(){B.addEventListener("click",()=>{re.classList.remove("visually-hidden"),ie.classList.remove("visually-hidden"),U.classList.remove("visually-hidden"),ce.classList.add("visually-hidden"),B.classList.add("visually-hidden"),de.innerText="Registro",_.classList.add("was-validated")})}let T=[],De=[],x;const D=document.querySelector("#registerForm"),Pe=D.username,b=D.email,C=D.password,Ue=document.querySelector("#loginButton"),Be=document.querySelector("#registerButton"),je=document.querySelector("#formModalClose");function W(){T=g("users")}Ae();Me();Be.addEventListener("click",async e=>{if(e.preventDefault(),T.find(t=>t.email===b.value))alert("La cuenta ya est\xE1 registrada");else if(D.checkValidity()){const t=await P(b.value,C.value),a=await P(C.value,JSON.stringify({email:b.value,username:Pe.value,_id:t,purchase:De}));Re(a)}});Ue.addEventListener("click",e=>{e.preventDefault();const t=T.find(a=>a.email===b.value);t?le(C.value,t.user):alert(b.value+" no registrada")});function Re(e){let t=te();T.push({_id:t,email:b.value,user:e}),N("users",T),le(C.value,e)}async function le(e,t){try{x=JSON.parse(await ee(e,t)),x&&(X("user",x),alert("Bienvenido "+x.username),je.click(),R(x))}catch{alert("Usuario y/o contrase\xF1a incorrectas")}}const _e=document.querySelector("#activateProfile"),Oe=document.querySelector("#activateCart"),He=document.querySelector("#nav-home-tab"),Z=document.querySelector("#nav-profile-tab");function Fe(){_e.addEventListener("click",()=>{Z.click()}),Z.addEventListener("click",()=>{g("users")&&W(),$("user")&&R($("user"))}),Oe.addEventListener("click",()=>{He.click(),g("users")&&W()})}const Ve=document.querySelector("#loaderSection");document.addEventListener("DOMContentLoaded",()=>{se(),g("carrito")&&ae(),Fe()});window.onload=()=>{Ve.setAttribute("style","visibility:hidden; opacity:0;")};
